---
title: "03_augment"
author: "Group12"
format: html
editor: visual
---

## Load libraries

```{r}
library("tidyverse")
library("dplyr")
```

## Load data

```{r}
# | echo: true
# | eval: true

#Load the file
body_measurements <- read_tsv(file = "../data/PCOS_body_measurements.tsv")
blood_measurements <- read_tsv(file = "../data/PCOS_blood_measurements.tsv")

```

# Augmenting data

```{r}
# | echo: true
# | eval: true

# Making PCOS diagnosis into yes and no
body_measurements <- body_measurements |> 
  mutate(PCOS_diagnosis = factor(PCOS_diagnosis, levels= c(0,1), labels=c("No", "Yes")))

blood_measurements <- blood_measurements |> 
  mutate(PCOS_diagnosis = factor(PCOS_diagnosis, levels= c(0,1), labels=c("No", "Yes")))

```

## Unit changes

```{r}
# | echo: true
# | eval: true

# Going from inches to cm + new hip/waist ratio
body_measurements <- body_measurements |> 
  mutate(hip = hip * 2.54)|>
  mutate(waist = waist * 2.54)|>
  mutate(waist_hip_ratio = round(waist_hip_ratio *2.54, 1))
  
```

## Rounding BMI and dividing into categories

```{r}
# | echo: true
# | eval: true

# round of BMI + categories
body_measurements <- body_measurements |>
  mutate(BMI = round(BMI, 1)) |> 
  mutate(BMI_class = case_when(
    BMI < 18.5 ~ "Underweight",
    BMI <= 18.5 | BMI < 25 ~ "Normal weight",
    BMI <= 25 | BMI < 30 ~ "Overweight",
    BMI >= 30 ~ "Obesity")) |>
  mutate(BMI_class = factor(BMI_class,
                            levels =  c("Underweight", "Normal weight",
                                        "Overweight", "Obesity"))) |>
  relocate(BMI_class, .after = BMI)
```

## Change blood type numbers into blood indicators

```{r}
# | echo: true
# | eval: true

# Change blood type into indicators
body_measurements <- body_measurements |>
  mutate(blood_type = case_when(
    blood_type == 11 ~ "A+",
    blood_type == 12 ~ "A-",
    blood_type == 13 ~ "B+",
    blood_type == 14 ~ "B-",
    blood_type == 15 ~ "O+",
    blood_type == 16 ~ "O-",
    blood_type == 17 ~ "AB+",
    blood_type == 18 ~ "AB-"))


```

## Change cycle status into strings

```{r}
# | echo: true
# | eval: true

# Change cycle status from numbers to strings
body_measurements <- body_measurements |>
  mutate(cycle_RI = case_when(
    cycle_RI == 2 ~ "irregular",
    cycle_RI == 4 ~ "regular"))
```

## Factor values

```{r}
# | echo: true
# | eval: true


```

## Save tsv files

```{r}
# Write the data into data files
write_tsv(x = blood_measurements,
          file = "../data/PCOS_blood_measurements_aug.tsv")
write_tsv(x = body_measurements,
          file = "../data/PCOS_body_measurements_aug.tsv")

PCOS_merged <- inner_join(x = body_measurements,
                          y = blood_measurements,
                          by = join_by(patient_ID, PCOS_diagnosis))
write_tsv(x = PCOS_merged,
          file = "../data/PCOS_merged.tsv")
```
